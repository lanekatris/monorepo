---
import Layout from "../layouts/Layout.astro";
import { formatRelative } from "date-fns";

interface ClimbResponsePoolCur {
  elev: number;
}

interface ClimbResponseSug {
  pool_cur: ClimbResponsePoolCur;
  data_timestamp: string;
}

interface ClimbResponse {
  sug: ClimbResponseSug;
}
process.env["NODE_TLS_REJECT_UNAUTHORIZED"] = "0";
const response = await fetch(
  "https://www.lrh-wc.usace.army.mil/wm/data/json/projects/sug_15M.min.json.js",
);

const data: ClimbResponse = await response.json();
const ll = formatRelative(new Date(data.sug.data_timestamp), new Date(), {});
---

<Layout title="Summersville Water Height">
  <!--<div class="container">-->
  <!--    <h2>adf</h2>-->
  <!--</div>-->
  <nav>
    <menu
      ><li><a href="/">Climb.Rest</a></li>

      <li class="selected">
        <a href="/summersville-wv-climbing">Summersville</a>
      </li></menu
    >
  </nav>
  <!--<nav>-->
  <!--  <ol>-->
  <!--    <li><a href="/">Home</a></li>-->
  <!--    <li><a href="/summersville-wv-climbing">Summersville Status</a></li>-->
  <!--  </ol>-->
  <!--</nav>-->
  <h1>Summersville Status</h1>
  <!--<h1>This is where we show the details: {data.sug.pool_cur.elev}</h1>-->
  <!--<progress class="accent" max=""-->
  <h3>Can rope climb @ Whipporwill?</h3>
  <div class="flash attention">No, you'll get wet! 🌊</div>
  <!--<small class="muted">⏱️ Last Updated: <b>{ll}</b></small>-->
  <small class="muted">Updates every ~12 hours</small>
  <!--<div class="flash default">-->
  <br />
  <br />
  <h3>Other Info</h3>
  <div>Current Water Height: <samp>{data.sug.pool_cur.elev}</samp> ft</div>
  <div>You can climb at: <samp>1620</samp> ft</div>
  <div>
    Feet left to change: <samp
      >{(data.sug.pool_cur.elev - 1620).toFixed(2)}</samp
    > ft
  </div>
  <div>📅 Re-fills around April 1st</div>
  <div>
    📈 Data sourced from <a
      href="https://www.lrh-wc.usace.army.mil/wm/?basin/kan/sug">here</a
    > (US Army Corps of Engineers)
  </div>
  <!--</div>-->
  <!--<br />-->
  <!--<article>-->
  <!--  <header>-->
  <!--    <h3>Other Info</h3>-->
  <!--  </header>-->
  <!--  <p>-->
  <!--    <dl>-->
  <!--      <dd>-->
  <!--        <div>-->
  <!--          Current Water Height: <samp>{data.sug.pool_cur.elev}</samp> ft-->
  <!--        </div>-->
  <!--      </dd>-->
  <!--      <dd>-->
  <!--        <div>You can climb at: <code>1620 ft</code></div>-->
  <!--      </dd>-->
  <!--    </dl>-->
  <!--    <div>Current Water Height: <samp>{data.sug.pool_cur.elev}</samp> ft</div>-->
  <!--    <div>You can climb at: <code>1620 ft</code></div>-->
  <!--    <div>-->
  <!--      Feet left to change: <code-->
  <!--        >{(data.sug.pool_cur.elev - 1620).toFixed(2)} ft</code-->
  <!--      >-->
  <!--    </div>-->
  <!--    <div>📅 Re-fills around April 1st</div>-->
  <!--    <div>-->
  <!--      📈 Data sourced from <a-->
  <!--        href="https://www.lrh-wc.usace.army.mil/wm/?basin/kan/sug">here</a-->
  <!--      > (US Army Corps of Engineers)-->
  <!--    </div>-->
  <!--  </p>-->
  <!--</article>-->
  <br />
  <br />
  <br />
</Layout>
